{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\katar\\\\Desktop\\\\Studia\\\\III Rok\\\\SmartHome\\\\SmartHome-front\\\\frontend\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport \"./App.css\";\nimport Login from \"./components/Login\";\nimport { Routes, Route, Navigate } from \"react-router-dom\";\nimport { useEffect, useState, useRef } from \"react\";\nimport Register from \"./components/Register\";\nimport Dashboard from \"./components/Dashboard\";\nimport AdminPanel from \"./components/AdminPanel\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [user, setUser] = useState(null);\n  const [sensors, setSensors] = useState([]);\n  const socketRef = useRef();\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"smartHomeUser\");\n    setUser(null);\n  };\n\n  useEffect(() => {\n    const response = localStorage.getItem(\"smartHomeUser\");\n\n    if (response) {\n      setUser(JSON.parse(response));\n    }\n  }, []);\n  useEffect(() => {\n    if (!user) return;\n    socketRef.current = io(process.env.REACT_APP_URL_BASE);\n    socketRef.current.on(\"connect\", () => {\n      console.log(\"connect to websocket\");\n    });\n    socketRef.current.on(\"add sensor\", newSensor => {\n      console.log(\"new sensor was added\", newSensor);\n      setSensors(prevSensors => [...prevSensors, newSensor]);\n    });\n    socketRef.current.on(\"update sensor\", updatedSensor => {\n      console.log(\"sensor was updated\", updatedSensor);\n      setSensors(prevSensors => prevSensors.map(sensor => sensor._id === updatedSensor._id ? updatedSensor : sensor));\n    });\n    socketRef.current.on(\"remove sensor\", id => {\n      console.log(\"sensor was removed\", id);\n      setSensors(prevSensors => prevSensors.filter(sensor => sensor._id !== id));\n    });\n    return () => socketRef.current.disconnect();\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Routes, {\n      children: [/*#__PURE__*/_jsxDEV(Route, {\n        path: \"/login\",\n        element: /*#__PURE__*/_jsxDEV(Login, {\n          setUser: setUser,\n          user: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/register\",\n        element: /*#__PURE__*/_jsxDEV(Register, {\n          user: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 42\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this), user ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/dashboard\",\n          element: /*#__PURE__*/_jsxDEV(Dashboard, {\n            user: user,\n            setUser: setUser,\n            handleLogout: handleLogout,\n            sensors: sensors,\n            setSensors: setSensors\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/admin-panel\",\n          element: /*#__PURE__*/_jsxDEV(AdminPanel, {\n            user: user,\n            setUser: setUser,\n            handleLogout: handleLogout,\n            setSensors: setSensors\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : null, /*#__PURE__*/_jsxDEV(Route, {\n        path: \"*\",\n        element: /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/login\",\n          replace: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 34\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"z82BTyYvxaLFhjdjklEATB5mpL8=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["C:/Users/katar/Desktop/Studia/III Rok/SmartHome/SmartHome-front/frontend/src/App.js"],"names":["Login","Routes","Route","Navigate","useEffect","useState","useRef","Register","Dashboard","AdminPanel","io","App","user","setUser","sensors","setSensors","socketRef","handleLogout","localStorage","removeItem","response","getItem","JSON","parse","current","process","env","REACT_APP_URL_BASE","on","console","log","newSensor","prevSensors","updatedSensor","map","sensor","_id","id","filter","disconnect"],"mappings":"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","sourcesContent":["import \"./App.css\";\r\nimport Login from \"./components/Login\";\r\nimport { Routes, Route, Navigate } from \"react-router-dom\";\r\nimport { useEffect, useState, useRef } from \"react\";\r\nimport Register from \"./components/Register\";\r\nimport Dashboard from \"./components/Dashboard\";\r\nimport AdminPanel from \"./components/AdminPanel\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nfunction App() {\r\n  const [user, setUser] = useState(null);\r\n  const [sensors, setSensors] = useState([]);\r\n  const socketRef = useRef();\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"smartHomeUser\");\r\n    setUser(null);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const response = localStorage.getItem(\"smartHomeUser\");\r\n    if (response) {\r\n      setUser(JSON.parse(response));\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    socketRef.current = io(process.env.REACT_APP_URL_BASE);\r\n    socketRef.current.on(\"connect\", () => {\r\n      console.log(\"connect to websocket\");\r\n    });\r\n    socketRef.current.on(\"add sensor\", (newSensor) => {\r\n      console.log(\"new sensor was added\", newSensor);\r\n      setSensors((prevSensors) => [...prevSensors, newSensor]);\r\n    });\r\n    socketRef.current.on(\"update sensor\", (updatedSensor) => {\r\n      console.log(\"sensor was updated\", updatedSensor);\r\n\r\n      setSensors((prevSensors) =>\r\n        prevSensors.map((sensor) =>\r\n          sensor._id === updatedSensor._id ? updatedSensor : sensor\r\n        )\r\n      );\r\n    });\r\n    socketRef.current.on(\"remove sensor\", (id) => {\r\n      console.log(\"sensor was removed\", id);\r\n      setSensors((prevSensors) =>\r\n        prevSensors.filter((sensor) => sensor._id !== id)\r\n      );\r\n    });\r\n    return () => socketRef.current.disconnect();\r\n  }, [user]);\r\n\r\n  return (\r\n    <div>\r\n      <Routes>\r\n        <Route\r\n          path=\"/login\"\r\n          element={<Login setUser={setUser} user={user} />}\r\n        />\r\n        <Route path=\"/register\" element={<Register user={user} />} />\r\n        {user ? (\r\n          <>\r\n            <Route\r\n              path=\"/dashboard\"\r\n              element={\r\n                <Dashboard\r\n                  user={user}\r\n                  setUser={setUser}\r\n                  handleLogout={handleLogout}\r\n                  sensors={sensors}\r\n                  setSensors={setSensors}\r\n                />\r\n              }\r\n            />\r\n            <Route\r\n              path=\"/admin-panel\"\r\n              element={\r\n                <AdminPanel\r\n                  user={user}\r\n                  setUser={setUser}\r\n                  handleLogout={handleLogout}\r\n                  setSensors={setSensors}\r\n                />\r\n              }\r\n            />\r\n          </>\r\n        ) : null}\r\n        <Route path=\"*\" element={<Navigate to=\"/login\" replace />} />\r\n      </Routes>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}